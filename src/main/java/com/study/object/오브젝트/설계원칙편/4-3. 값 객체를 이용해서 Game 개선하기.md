---

# 🎮 게임 코드 리팩터링 핵심 정리

## ― 값 객체(Value Object)로 숨겨진 개념 드러내기

---

## 1. 왜 값 객체를 사용하는가?

### 🔍 문제 인식

* `x`, `y`, `width`, `height` 처럼 **여러 곳에서 항상 함께 사용되는 값들**이 존재
* 메서드 인자, 필드, 로직에서 **반복적으로 함께 등장**
* 하지만 코드에서는 **단순한 숫자 변수**로만 표현됨

👉 이는 **“숨겨진 개념(Semantic Concept)”** 이 존재한다는 신호

---

## 2. 숨겨진 개념을 찾는 기준

다음 신호가 보이면 값 객체 후보다:

* 항상 함께 전달되는 변수들
* 함께 변경되는 값들
* 함께 검증되는 값들
* 이름 없이 숫자/원시 타입으로만 표현된 값들

---

## 3. Position 값 객체 ― “위치” 개념 드러내기

### 📌 숨겨진 개념

* `x`, `y` → **위치(Position)**

### ✨ 개선 방식

```text
(x, y) → Position
```

### Position의 책임

* 좌표 값 보관 (`x`, `y`)
* 좌표 이동 로직 (`shift`)
* 방향에 따른 이동

### 핵심 설계 원칙

* **불변 객체 (immutable)**
* 모든 필드는 `final`
* 상태 변경 대신 **새 인스턴스 반환**

```text
Position.shift(...) → 새로운 Position 반환
```

### 효과

* 게임 클래스에서 좌표 계산 로직 제거
* “위치를 이동한다”는 의미가 코드에 명확히 드러남

---

## 4. Size 값 객체 ― “크기” 개념 드러내기

### 📌 숨겨진 개념

* `width`, `height` → **크기(Size)**

### ✨ 개선 방식

```text
(width, height) → Size
```

### Size의 책임

* 맵의 넓이 계산 (`area`)
* 좌표가 맵 안에 있는지 판단 (`contains`)
* 좌표 → 배열 인덱스 변환 (`indexOf`)

### 효과

* 맵 관련 로직이 한 곳에 응집
* 게임 클래스는 “무엇을 한다”만 표현

---

## 5. Direction 열거형 ― 방향 개념 명시화

### 📌 문제

* `x + 1`, `y - 1` 같은 숫자 연산은 **의미가 불분명**
* 동서남북 이동을 코드만 보고 직관적으로 이해하기 어려움

### ✨ 해결

```text
숫자 → Direction (North, South, East, West)
```

### 개선 포인트

* `move(1, 0)` ❌
* `move(Direction.EAST)` ✅

### 책임 이동

* 방향에 따른 좌표 변경 로직을 `Position` 내부로 캡슐화

---

## 6. 값 객체 설계 원칙 정리

### ✅ 값 객체란?

* **의미 있는 값을 표현하는 작은 객체**
* 데이터 + 관련 로직을 함께 가짐

### 설계 원칙

* 불변성 유지
* 생성 시 완전한 상태
* 행위는 있으나 상태 변경은 없음
* 작고 재사용 가능

---

## 7. 리팩터링 전후 비교

### 리팩터링 전

* 게임 클래스가 모든 계산 책임
* 숫자 인자의 의미를 기억해야 이해 가능
* 메서드 수 증가 → 복잡도 증가

### 리팩터링 후

* 위치, 크기, 방향이 코드에 명시적으로 드러남
* 게임 클래스는 **조율자(Orchestrator)** 역할
* 중복 제거 + 가독성 향상

---

## 8. 작은 리팩터링의 누적 효과

> “작아 보이는 리팩터링이 쌓이면
> 비교할 수 없을 정도로 코드가 좋아진다”

* 메서드 분리
* 값 객체 추출
* 의미 없는 숫자 제거
* 책임 이동

👉 이후 **SRP(단일 책임 원칙)** 적용이 쉬워짐

---

## 9. 사고 방식 요약 (기억용)

### 🧠 코드 분석할 때 스스로에게 던질 질문

* 이 값들은 왜 항상 같이 다니지?
* 이 숫자들은 어떤 개념을 표현하지?
* 이 로직은 정말 이 클래스 책임일까?

### ✨ 답

* 개념을 **클래스로 승격**
* 로직을 **의미 있는 곳으로 이동**

---

## 10. 한 줄 요약

> **값 객체는 데이터를 묶는 기술이 아니라
> 코드에 ‘의미’를 새기는 도구다.**

---